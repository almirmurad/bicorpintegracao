o que precisamos capturar do webhook para salvar na base de dados

1 - Action (Win);
2 - Entity (Deals);
3 - SecondaryEntityId ?;
4 - AccountId ?;
5 - AccountUserId ?;
6 - WebhookId (Id Webhook);
7 - WebhookCreatorId (Id de quem criou o webhook);
8 - Data do disparo;

O que precisamos capturar do Deal?

1  - Base de Faturamento (chave de OtherProperties);
2  - Id do Deal;
3  - ContactId (Id do cliente);
4  - PersonId (Id do contato);
5  - PipelineId (Id do Fúnil de vendas);
6  - StageId (Id da coluna do funil);
7  - StatusId (Stuação);
8  - WonQuoteId (Proposta ganha);
9  - OwnerId (Proprietário no ploomes/vendedor Omie);
10 - CreateDate (data da criação);
11 - LastOrderId (Id da venda);
12 - CreatorId (Id do criador);

O que precisamos capturar do Contact?

O contact (Cliente) está cadastrado no ploomes e no omie, precisamos identifica-los no ploomes para indicar na venda do omie, portanto creio que não se faça necessário por já ter estes dados cadastrados em ambos os sistemas. O que precisamos e relaciona-los.

O que precisamos capturar do produto?

O produto segue a lógica dos clientes, ele já está cadastrado nos dois sistemas, precisamos encontrar uma relação entre os dois sistemas. 
No ploomes o existe o Code (Codigo), uma referencia ao produto, o Id (identificador no ploomes) e o Id Omie, que se referencia ao Id do produto no Omie integrado. 
Não podemos usar o Id pq ele esta apenas no ploomes e ele não é reconhecido pelo omie, não podemos usar o IdOmie pq ele esta atrelado a uma unica base do Omie e muda para as outras duas. O Code é um código que pode ser usado pra referenciar o produto no omie e está ligado as 3 bases, ao menos para os produtos que testei. 
Ele pode ser utilizado para encontrar o produto no omie através da api e retornar o codigo do omie para o produto ser inserido no pedido.

O que precisamos do Owner (proprietário ploomes/vendedor Omie)

O vendedor está cadastrados nas 3 bases como códigos diferentes, mas podemos fazer uma busca através do email do vendedor, mas ele precisa estar cadastrado nas 3 bases com o mesmo email.

Chaves criptografadas do Array OtherProperties em Fiel Ploomes 
            
    deal_71A027EA-ED63-438B-9C1B-90F27CC37519: Qual Situação atual?
    deal_12ADAA7D-3A71-4F96-98B7-A02D7FA06E34: Quais Problemas a resolver?
    deal_86048E40-AC50-4D0F-9C13-65AFCAF03C39: Quais Implicações da oportunidade e negócio?
    deal_FA811737-0B26-4CAC-8176-E070D7A1A68B: Quais Necessidades reais?
    deal_2B864174-1945-48D6-98C0-17A70F54069C: Existe orçamento definido?
    deal_E3BDC96B-D67F-46AB-8CED-1C76AD1D2794: Quem é a Autoridade e decisores?
    deal_D407DEDD-4CC1-47E8-ABA2-67F6596190FA: Qual o lead Time para fechamento da oportunidade?
    deal_197C3993-ABE8-4C1E-A3AC-DFC09EB5D130: Quais os objetivos  de negócio da empresa?
    deal_CC09808E-4EA9-4F38-9367-5BDC27FE86F7: Possúi um plano definido para atingir os objetivos?
    deal_B9F4C5CA-1E8E-418C-963B-8D366A849E04: Quais os principais desafios para atingir os objetivos?
    deal_04889A4C-744D-4E2E-9A39-32E11E4316F5: Em quanto tempo pretende atingir os objetivos?
    deal_A965E8F5-EF81-4CF3-939D-1D7FE6F1556C: Base de Faturamento
    deal_B2ED70A0-34D5-48BB-A80A-2680840E4A3E: Prazo de fechamento
    deal_D9F5D6A1-5C1E-41F0-83A3-BEFC07DE42B2: Elaboração de proposta
    deal_39EEE876-1361-4FE8-828B-B2558A006BE8: Agendar envio/apresentação (calendário)
    deal_4EE6A3DF-9AAA-4C83-AEC6-BF597391A400: Apresentar e/ou confirmar recebimento
    deal_EE26C4FD-F90F-4F5A-A8C1-9806B852337E: Feedback (avaliação para seguir p/ negociação)
    deal_39131090-80B9-432E-8E33-0B7D13BBD138: Será necessário refinar a proposta?
    deal_EE415DA0-5EB4-4259-B026-C48C5279B985: O que foi refinado?
    deal_6B97886F-687E-4F74-8F1C-66C1CBD88462: Refino feito?
    deal_B5A18E01-B531-4D80-B2FD-25FB84720DCA: Orçamento aprovado?
    deal_E213DF4B-632C-45D4-A98E-6995F930DA84: Obter Condição de fechamento
    deal_8F36D31A-0B86-4F77-9D6C-7EC7A6AF52F3: Alinhar forma de contratação
    deal_3D4D7304-3FA7-443F-A5C9-7DCD48214720: Validar prazo de entrega para retorno ao cliente


Interaction Records - interações no deal 
    url = {{server}}InteractionRecords($dealId)
    parametros = $contactId, $dealId, $title, $content
    tipos de interações:
    1 mensagem simples
    2 visita
    3 telefone 
    4 email
    5 reunião
    6 conferencia
    7 whatsapp
Body da requisição
    {
    "ContactId": 408769646,
    "DealId": 406004982,
    "Title": "Nota Fiscal emitida",
    "Content": "NF: 123457"  
    }

orderStage - mudar o estágio da venda 
    method = PATCH
    URL = {{server}}/Orders($numOrder)
    "Id": 40009975,
    "Name": "Pedido recebido",
    "Id": 40009976,
    "Name": "Produto na transportadora",
    "Id": 40009977,
    "Name": "Produto entregue",


ter contas em ploomes e omie
Não podemos ter vendedores com email iguais
produtos precisam obrigatoriamente estarem cadastrados em ambas as bases
secret key e appkey do omie precisam ser conhecidas
apikey do ploomes precisa ser conhecida
precisamos pegar o id do vendedor 
id da conta corrente no omie
precisamos saber como pegar as observações em uma venda



            "descricao": "88 Digital"
            "descricao": "Americanas"
            "descricao": "Amazon"
            "descricao": "Integração (API)"
            "descricao": "App Sistemas"
            "descricao": "B2W"
            "descricao": "BLP.IT"
            "descricao": "Cnova"
            "descricao": "Devi Pré-Venda"
            "descricao": "Devi Smart Orders"
            "descricao": "Omie"
            "descricao": "iSet"
            "descricao": "Jet Commerce"
            "descricao": "LukBuk"
            "descricao": "Loja Integrada"
            "descricao": "Leroy Merlin"
            "descricao": "MaxSmart PDV"
            "descricao": "MadeiraMadeira"
            "descricao": "Magento"
            "descricao": "MK Pré-Venda"
            "descricao": "Mercado Livre"
            "descricao": "Mercos"
            "descricao": "Magazine Luiza"
            "descricao": "Netshoes"
            "descricao": "Nuvem Shop"
            "descricao": "Olist"
            "descricao": "Portal Omie"
            "descricao": "Shopify"
            "descricao": "Shopee"
            "descricao": "Simplo7"
            "descricao": "Mercado Livre (Via Tray)"
            "descricao": "Tray"
            "descricao": "Velis CRM"
            "descricao": "Wapstore"
            "descricao": "Wix"
            "descricao": "Woocommerce"
            "descricao": "Xtech"
            "descricao": "Y"

            "descricao": "88 Digital"
            "descricao": "Americanas"
            "descricao": "Amazon"
            "descricao": "Integração (API)"
            "descricao": "App Sistemas"
            "descricao": "B2W"
            "descricao": "BLP.IT"
            "descricao": "Cnova"
            "descricao": "Devi Pré-Venda"
            "descricao": "Devi Smart Orders"
            "descricao": "Omie"
            "descricao": "iSet"
            "descricao": "Jet Commerce"
            "descricao": "LukBuk"
            "descricao": "Loja Integrada"
            "descricao": "Leroy Merlin"
            "descricao": "MaxSmart PDV"
            "descricao": "MadeiraMadeira"
            "descricao": "Magento"
            "descricao": "MK Pré-Venda"
            "descricao": "Mercado Livre"
            "descricao": "Mercos"
            "descricao": "Magazine Luiza"
            "descricao": "Netshoes"
            "descricao": "Nuvem Shop"
            "descricao": "Olist"
            "descricao": "Portal Omie"
            "descricao": "Shopify"
            "descricao": "Shopee"
            "descricao": "Simplo7"
            "descricao": "Mercado Livre (Via Tray)"
            "descricao": "Tray"
            "descricao": "Velis CRM"
            "descricao": "Wapstore"
            "descricao": "Wix"
            "descricao": "Woocommerce"
            "descricao": "Xtech"
            "descricao": "Yampi"